
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>mann_kendall documentation</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-02-14"><meta name="DC.source" content="mann_kendall_documentation.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1><tt>mann_kendall</tt> documentation</h1><!--introduction--><p><tt>mann_kendall</tt> performs a standard simple Mann-Kendall test on the time series y to determine the presence of a significant trend. (Requires Statistics Toolbox)</p><p><a href="CDT_Contents.html">Back to Climate Data Tools Contents</a>.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Example 1: 1D array</a></li><li><a href="#11">Example 2: Multiple time series</a></li><li><a href="#16">Example 3: 3D data</a></li><li><a href="#20">References</a></li><li><a href="#21">Author Info</a></li></ul></div><h2 id="1">Syntax</h2><pre>h = mann_kendall(y)
h = mann_kendall(y,alpha)
h = mann_kendall(...,'dim',dim)
[h,p] = mann_kendall(...)</pre><h2 id="2">Description</h2><p><tt>h = mann_kendall(y)</tt> performs a standard simple Mann-Kendall test on the time series <tt>y</tt> to determine the presence of a significant trend. If <tt>h</tt> is <tt>true</tt>, the trend is present; if <tt>h</tt> is <tt>false</tt>, you can reject the hypothesis of a trend. This function assumes <tt>y</tt> is equally sampled in time.</p><p><tt>h = mann_kendall(y,alpha)</tt> specifies the alpha significance level in the range 0 to 1. Default <tt>alpha is 0.05</tt>, which corresponds to the 5% significance level.</p><p><tt>h = mann_kendall(...,'dim',dim)</tt> specifies the dimension along which the trend is calculated. By default, if <tt>y</tt> is a 1D array, the trend is calculated along the first nonsingleton dimension of <tt>y</tt>; if <tt>y</tt> is a 2D matrix, the trend is calcaulated down the rows (dimension 1) of <tt>y</tt>; if <tt>y</tt> is a 3D matrix, the trend is calculated down dimension 3.</p><p><tt>[h,p] = mann_kendall(...)</tt> also returns the p-value of the trend.</p><h2 id="3">Example 1: 1D array</h2><p>Consider these two arrays, one with a trend and one without:</p><pre class="codeinput">x = (1:1000)';
y0 = randn(size(x)) + 1000;         <span class="comment">% random data without trend</span>
y1 = randn(size(x)) + 1000 + x/500; <span class="comment">% random data with trend of 1/500</span>

plot(x,y0,<span class="string">'b'</span>);
hold <span class="string">on</span>
plot(x,y1,<span class="string">'r'</span>);
</pre><img vspace="5" hspace="5" src="mann_kendall_documentation_01.png" alt=""> <p>To help show the trends, use <a href="polyplot_documentation.html"><tt>polyplot</tt></a>, which will plot the first-degree polynomial trend lines for <tt>y0</tt> and <tt>y1</tt>.</p><pre class="codeinput">polyplot(x,y0,1,<span class="string">'linewidth'</span>,2)
polyplot(x,y1,1,<span class="string">'linewidth'</span>,2)
</pre><img vspace="5" hspace="5" src="mann_kendall_documentation_02.png" alt=""> <p>And just to verify the magnitudes of the trends in <tt>y0</tt> and <tt>y1</tt>, use the <a href="trend_documentation.html"><tt>trend</tt></a> function:</p><pre class="codeinput">trend(y0)
</pre><pre class="codeoutput">ans =
  -7.7958e-05
</pre><p>...as expected, the trend in <tt>y0</tt> is about zero. Now check <tt>y1</tt>:</p><pre class="codeinput">trend(y1)
</pre><pre class="codeoutput">ans =
    0.0019
</pre><p>...and as expected, the trend in <tt>y1</tt> is 1/500 as we intentionally imposed. Both of these trend magnitudes may seem like small numbers that are close to zero, while not being exactly zero. So are either of these trends significant? Use <tt>mann_kendall</tt> to find out, starting with <tt>y0</tt>:</p><pre class="codeinput">mann_kendall(y0)
</pre><pre class="codeoutput">ans =
  logical
   0
</pre><p>The <tt>false</tt> (logical zero) confirms it: The <tt>y0</tt> time series contains nothing but noise. Now check <tt>y1</tt>, in which, recall, we imposed a trend of 1/500:</p><pre class="codeinput">mann_kendall(y1)
</pre><pre class="codeoutput">ans =
  logical
   1
</pre><p>The logical 1 or <tt>true</tt> answer confirms that although <tt>y1</tt> contains noise and its trend is small in terms of magnitude, the trend is nonetheless present at the default alpha = 5% significance level. Is 5% significance not strict enough for you? Tighten it up to 0.1% like this:</p><pre class="codeinput">mann_kendall(y1,0.001)
</pre><pre class="codeoutput">ans =
  logical
   1
</pre><p>And that confirms that the trend in <tt>y1</tt> is present at 0.1% significance.</p><h2 id="11">Example 2: Multiple time series</h2><p>If you have multiple time series in a 2D matrix, the <tt>mann_kendall</tt> function can operate on them all at once. For example, we'll make a dataset <tt>D</tt> using the two 1D array time series from Example 1:</p><pre class="codeinput">D = [y0 y1];
</pre><p>By default, if the input to <tt>mann_kendall</tt> is a 2D matrix, the function will operate down the rows, so testing for significance of trends in <tt>y0</tt> and <tt>y1</tt> is this easy:</p><pre class="codeinput">mann_kendall(D)
</pre><pre class="codeoutput">ans =
  1&times;2 logical array
   0   1
</pre><p>The <tt>0</tt> and <tt>1</tt> answer means there no significant trend in the first column of <tt>D</tt>, but there is a significant trend in the second column of <tt>D</tt>.</p><p>If each time series is in its own row rather than in its own column, specify the dimension of operation like this:</p><pre class="codeinput">Dt = D'; <span class="comment">% transpose D to make time go across columns of Dt.</span>

mann_kendall(Dt,<span class="string">'dim'</span>,2)
</pre><pre class="codeoutput">ans =
  2&times;1 logical array
   0
   1
</pre><p>It's also possible to specify the significance level alpha. Let's <i>really</i> relax our standards, and set it to 99.999%:</p><pre class="codeinput">mann_kendall(Dt,0.99999,<span class="string">'dim'</span>,2)
</pre><pre class="codeoutput">ans =
  2&times;1 logical array
   1
   1
</pre><p>Wow, if we relax our standards enough, even the <tt>y0</tt> noise contains what appears to be a significant trend!</p><h2 id="16">Example 3: 3D data</h2><p>Have sea surface temperatures significantly changed in the past few decades? To answer that question, load the 60x55x802 pacific_sst dataset, which contains a grid of 802 monthly sea surface temperatures from 1950 to 2016:</p><pre class="codeinput">load <span class="string">pacific_sst</span>
</pre><p>With a sampling rate of 12 times per year (monthly data), use the <a href="trend_documentation.html"><tt>trend</tt></a> function to calculate the SST trend in degrees per year, and use <a href="imagescn_documentation.html"><tt>imagescn</tt></a> to make a map. Set the colormap with <a href="cmocean_documentation.html"><tt>cmocean</tt></a>:</p><pre class="codeinput"><span class="comment">% Calculate the SST trend:</span>
tr = trend(sst,12);

<span class="comment">% Plot the trend:</span>
figure
imagescn(lon,lat,tr)
cb = colorbar;
ylabel(cb,<span class="string">'sst trend (\circC/yr)'</span>)
cmocean(<span class="string">'balance'</span>,<span class="string">'pivot'</span>)
</pre><img vspace="5" hspace="5" src="mann_kendall_documentation_03.png" alt=""> <p>The map above shows that in most places, the ocean seems to be warming. But is the trend significant? Use the <tt>mann_kendall</tt> function to find out, and plot the significant regions using the <a href="stipple_documentation.html"><tt>stipple</tt></a> function:</p><pre class="codeinput">significant = mann_kendall(sst); <span class="comment">% (may take a second)</span>

hold <span class="string">on</span>
stipple(lon,lat,significant)
</pre><img vspace="5" hspace="5" src="mann_kendall_documentation_04.png" alt=""> <p>The map above shows that the SST trend is significant most places, at the alpha = 5% level. Feel free to try it with stricter standards.</p><p>Curious about what effects the seasons might have on the calculation? Try using <a href="deseason_documentation.html"><tt>deseason</tt></a> to remove seasonal cycles from the sst dataset and re-calculate the trends and significance.</p><h2 id="20">References</h2><p>Mann, H. B. (1945), Nonparametric tests against trend, Econometrica, 13, 245-259.</p><p>Kendall, M. G. (1975), Rank Correlation Methods, Griffin, London.</p><h2 id="21">Author Info</h2><p>This function is part of the <a href="http://www.github.com/chadagreene/CDT">Climate Data Toolbox for Matlab</a>. The function and supporting documentation were written by Chad A. Greene, adapted from the <a href="https://www.mathworks.com/matlabcentral/fileexchange/25531"><tt>Mann_Kendall</tt></a> function by Simone Fatichi.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% |mann_kendall| documentation
% |mann_kendall| performs a standard simple Mann-Kendall test on the
% time series y to determine the presence of a significant trend. (Requires
% Statistics Toolbox)
% 
% <CDT_Contents.html Back to Climate Data Tools Contents>. 
%% Syntax
% 
%  h = mann_kendall(y)
%  h = mann_kendall(y,alpha)
%  h = mann_kendall(...,'dim',dim)
%  [h,p] = mann_kendall(...)
% 
%% Description
% 
% |h = mann_kendall(y)| performs a standard simple Mann-Kendall test on the
% time series |y| to determine the presence of a significant trend. If |h| is
% |true|, the trend is present; if |h| is |false|, you can reject the
% hypothesis of a trend. This function assumes |y| is equally sampled in time. 
% 
% |h = mann_kendall(y,alpha)| specifies the alpha significance level in the
% range 0 to 1. Default |alpha is 0.05|, which corresponds to the 5% significance 
% level.
% 
% |h = mann_kendall(...,'dim',dim)| specifies the dimension along which the
% trend is calculated. By default, if |y| is a 1D array, the trend is calculated
% along the first nonsingleton dimension of |y|; if |y| is a 2D matrix, the trend
% is calcaulated down the rows (dimension 1) of |y|; if |y| is a 3D matrix, the 
% trend is calculated down dimension 3. 
% 
% |[h,p] = mann_kendall(...)| also returns the p-value of the trend. 
% 
%% Example 1: 1D array
% Consider these two arrays, one with a trend and one without: 

x = (1:1000)'; 
y0 = randn(size(x)) + 1000;         % random data without trend
y1 = randn(size(x)) + 1000 + x/500; % random data with trend of 1/500

plot(x,y0,'b'); 
hold on
plot(x,y1,'r'); 

%%
% To help show the trends, use <polyplot_documentation.html |polyplot|>, which
% will plot the first-degree polynomial trend lines for |y0| and |y1|. 

polyplot(x,y0,1,'linewidth',2)
polyplot(x,y1,1,'linewidth',2)

%% 
% And just to verify the magnitudes of the trends in |y0| and |y1|, use the
% <trend_documentation.html |trend|> function: 

trend(y0)

%% 
% ...as expected, the trend in |y0| is about zero. Now check |y1|: 

trend(y1)

%% 
% ...and as expected, the trend in |y1| is 1/500 as we intentionally
% imposed. Both of these trend magnitudes may seem like small numbers that
% are close to zero, while not being exactly zero. So are either of these
% trends significant? Use |mann_kendall| to find out, starting with |y0|: 

mann_kendall(y0)

%% 
% The |false| (logical zero) confirms it: The |y0| time series contains
% nothing but noise. Now check |y1|, in which, recall, we imposed a trend
% of 1/500: 

mann_kendall(y1)

%% 
% The logical 1 or |true| answer confirms that although |y1| contains noise
% and its trend is small in terms of magnitude, the trend is nonetheless present 
% at the default alpha = 5% significance level. Is 5% significance not
% strict enough for you? Tighten it up to 0.1% like this: 

mann_kendall(y1,0.001)

%% 
% And that confirms that the trend in |y1| is present at 0.1% significance.

%% Example 2: Multiple time series 
% If you have multiple time series in a 2D matrix, the |mann_kendall| function 
% can operate on them all at once. For example, we'll make a dataset |D| 
% using the two 1D array time series from Example 1: 

D = [y0 y1]; 

%% 
% By default, if the input to |mann_kendall| is a 2D matrix, the function
% will operate down the rows, so testing for significance of trends in |y0|
% and |y1| is this easy: 

mann_kendall(D)

%% 
% The |0| and |1| answer means there no significant trend in the first
% column of |D|, but there is a significant trend in the second column of
% |D|. 
% 
% If each time series is in its own row rather than in its own column,
% specify the dimension of operation like this: 

Dt = D'; % transpose D to make time go across columns of Dt.

mann_kendall(Dt,'dim',2)

%%
% It's also possible to specify the significance level alpha. Let's
% _really_ relax our standards, and set it to 99.999%: 

mann_kendall(Dt,0.99999,'dim',2)

%%
% Wow, if we relax our standards enough, even the |y0| noise contains what
% appears to be a significant trend! 

%% Example 3: 3D data 
% Have sea surface temperatures significantly changed in the past few decades? 
% To answer that question, load the 60x55x802 pacific_sst dataset, which
% contains a grid of 802 monthly sea surface temperatures from 1950 to
% 2016: 

load pacific_sst 

%% 
% With a sampling rate of 12 times per year (monthly data), use the
% <trend_documentation.html |trend|> function to calculate the SST trend in
% degrees per year, and use <imagescn_documentation.html |imagescn|> to
% make a map. Set the colormap with <cmocean_documentation.html |cmocean|>:

% Calculate the SST trend: 
tr = trend(sst,12); 

% Plot the trend: 
figure
imagescn(lon,lat,tr)
cb = colorbar; 
ylabel(cb,'sst trend (\circC/yr)') 
cmocean('balance','pivot') 

%% 
% The map above shows that in most places, the ocean seems to be warming.
% But is the trend significant? Use the |mann_kendall| function to find
% out, and plot the significant regions using the
% <stipple_documentation.html |stipple|> function: 

significant = mann_kendall(sst); % (may take a second)

hold on
stipple(lon,lat,significant)

%% 
% The map above shows that the SST trend is significant most places, at the
% alpha = 5% level. Feel free to try it with stricter standards. 
% 
% Curious about what effects the seasons might have on the calculation? Try
% using <deseason_documentation.html |deseason|> to remove seasonal cycles
% from the sst dataset and re-calculate the trends and significance. 

%% References 
% 
% Mann, H. B. (1945), Nonparametric tests against trend, Econometrica, 13, 
% 245-259.
% 
% Kendall, M. G. (1975), Rank Correlation Methods, Griffin, London.
% 
%% Author Info
% This function is part of the <http://www.github.com/chadagreene/CDT Climate Data Toolbox for Matlab>.
% The function and supporting documentation were written by Chad A. Greene,
% adapted from the <https://www.mathworks.com/matlabcentral/fileexchange/25531 |Mann_Kendall|> function by Simone 
% Fatichi.

##### SOURCE END #####
--></body></html>