
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>daily_insolation documentation</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-02-22"><meta name="DC.source" content="daily_insolation_documentation.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1><tt>daily_insolation</tt> documentation</h1><!--introduction--><p><tt>daily_insolation</tt> computes daily average insolation as a function of day and latitude at any point during the past 5 million years.</p><p>This function is from Ian Eisenman and Peter Huybers (see the reference below). The <tt>daily_insolation</tt> function is quite similar to the <a href="solar_radiation_documentation.html"><tt>solar_radiation</tt></a> function, but one may suit your needs better than the other. The <tt>daily_insolation</tt> function is best suited for investigations involving orbital changes over thousands to millions of years, whereas the <tt>solar_radiation</tt> may be easier to use for applications such as present-day precipitation/drought research.</p><p><a href="CDT_Contents.html">Back to Climate Data Tools Contents</a>.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Example 1</a></li><li><a href="#5">Example 2</a></li><li><a href="#6">Example 3</a></li><li><a href="#8">Example 4</a></li><li><a href="#9">Example 5</a></li><li><a href="#11">Example 6</a></li><li><a href="#12">Detailed description of calculation:</a></li><li><a href="#13">References:</a></li><li><a href="#14">Authors:</a></li></ul></div><h2 id="1">Syntax</h2><pre>Fsw = daily_insolation(kyear,lat,day)
Fsw = daily_insolation(kyear,lat,day,day_type)
Fsw = daily_insolation(kyear,lat,day,day_type,'constant',So)
Fsw = daily_insolation(kyear,lat,day,day_type,'mjmd')
[Fsw, ecc, obliquity, long_perh] = daily_insolation(...)</pre><h2 id="2">Description</h2><p><tt>Fsw = daily_insolation(kyear,lat,day)</tt> gives the daily average insolation in W/m^2 at latitude(s) on specified day(s) of the year (as given by the <a href="doy_documentation.html"><tt>doy</tt></a> function) for the times <tt>kyear</tt>, which are thousands of years before present. For example, use <tt>kyear = +3000</tt> to indicate 3 million years before present. Maximum allowed value of <tt>kyear</tt> is <tt>5000</tt>.</p><p><tt>Fsw = daily_insolation(kyear,lat,day,day_type)</tt> specifies an optional day type as <tt>1</tt> (default) or <tt>2</tt>. The default option <tt>1</tt> specifies days in the range 1 to 365.24, where day 1 is January first and the vernal equinox always occurs on day 80. Option 2 specifies day input as solar longitude in the range 0 to 360 degrees. Solar longitude is the angle of the Earth's orbit measured from spring equinox (21 March). Note that calendar days and solar longitude are not linearly related because, by Kepler's Second Law, Earth's angular velocity varies according to its distance from the sun. If day_type is negative, <tt>kyear</tt> is taken to be a 3 element array containing [eccentricity, obliquity, and longitude of perihelion].</p><p><tt>Fsw = daily_insolation(kyear,lat,day,day_type,'constant',So)</tt> specfies a solar constant <tt>So</tt>. Default <tt>So</tt> is <tt>1365</tt> W/m^2.</p><p><tt>Fsw = daily_insolation(kyear,lat,day,day_type,'mjmd')</tt> returns <tt>Fsw</tt> in units of (MJ/m^2)/day rather than the default W/m^2.</p><p><tt>[Fsw, ecc, obliquity, long_perh] = daily_insolation(...)</tt> also returns the orbital eccentricity, obliquity, and longitude of perihelion (precession angle).</p><h2 id="3">Example 1</h2><p>For this example, calculate summer solstice insolation at 65 N. We'll do it two different ways. First, use <a href="doy_documentation.html"><tt>doy</tt></a> to get the day of year corresponding to solstice, assuming it occurs on June 20:</p><pre class="codeinput">kyr = 0:1000;

Fsw_jun20 = daily_insolation(kyr,65,doy(<span class="string">'june 20'</span>));

plot(kyr,Fsw_jun20)
set(gca,<span class="string">'xdir'</span>,<span class="string">'reverse'</span>) <span class="comment">% reverses x direction</span>
ylabel(<span class="string">'summer solstice insolation at 65\circN (W m^{-1})'</span>)
xlabel <span class="string">'thousands of years before present'</span>
</pre><img vspace="5" hspace="5" src="daily_insolation_documentation_01.png" alt=""> <p>Rather than approximating June 20 as the solstice, a more precise way would be to specify the exact orbital angle corresponding to the solstice (90 degrees) using the <tt>day_type=2</tt> option, like this:</p><pre class="codeinput">Fsw_exact = daily_insolation(kyr,65,90,2);

hold <span class="string">on</span>
plot(kyr,Fsw_exact)

legend(<span class="string">'June 20'</span>,<span class="string">'exact'</span>)
</pre><img vspace="5" hspace="5" src="daily_insolation_documentation_02.png" alt=""> <h2 id="5">Example 2</h2><p>We can plot the difference between June 20 (calendar day) and the exact summer solstice insolation at 65 N</p><pre class="codeinput">Fsw_jun20 = daily_insolation(kyr,65,doy(<span class="string">'june 20'</span>));
Fsw_exact = daily_insolation(kyr,65,90,2);

figure
plot(kyr,Fsw_jun20-Fsw_exact)
set(gca,<span class="string">'xdir'</span>,<span class="string">'reverse'</span>) <span class="comment">% reverses x direction</span>
ylabel(<span class="string">'difference in solstice insolation at 65\circN (W m^{-1})'</span>)
xlabel <span class="string">'thousands of years before present'</span>
</pre><img vspace="5" hspace="5" src="daily_insolation_documentation_03.png" alt=""> <h2 id="6">Example 3</h2><p>Insolation for the current orbital configuration as a function of day and latitude. Since this is a function of two variables, use <tt>meshgrid</tt> to create grids of the day and latitude variables:</p><pre class="codeinput">[day,lat]=meshgrid(1:5:365, -90:90);
[Fsw,ecc,obl,omega]=daily_insolation(0,lat,day);

disp([ecc,obl,omega]) <span class="comment">% displays optional outputs</span>
</pre><pre class="codeoutput">    0.0172   23.4460  281.3700
</pre><p>We can now plot insolation as a function of day and latitude like this:</p><pre class="codeinput">figure
[c,h]=contour(day,lat,Fsw,[0:50:500]);
clabel(c,h)
xlabel <span class="string">'day of year'</span>
ylabel <span class="string">'latitude'</span>
title <span class="string">'present day insolation (W m^{-2})'</span>
</pre><img vspace="5" hspace="5" src="daily_insolation_documentation_04.png" alt=""> <h2 id="8">Example 4</h2><p>Calculate <i>annual</i> (not daily) average insolation by explicitly specifying orbital parameters.</p><pre class="codeinput">ecc=0.017236;
obl=23.446;
omega=101.37+180;
[day,lat]=meshgrid(1:5:365, -90:90);

Fsw=daily_insolation([ecc,obl,omega],lat,day,-1);

Fsw_annual = mean(Fsw,2);


figure
plot(-90:90,Fsw_annual)
axis <span class="string">tight</span>
xlabel <span class="string">'latitude'</span>
ylabel <span class="string">'annual mean insolation (W m^{-2})'</span>
</pre><img vspace="5" hspace="5" src="daily_insolation_documentation_05.png" alt=""> <h2 id="9">Example 5</h2><p>Compare calculated insolation with example values given by Berger (1991). Start by loading Earth's orbital parameters from <a href="https://doi.org/10.1016/0277-3791(91)90033-Q">Berger A. and Loutre M.F., 1991</a>, which is included as a sample dataset in CDT. Note, Berger and Loutre used negative values for their kiloyears, so we'll have to multiply them by -1. Also, they used a solar constant of 1360 W/m^2 so we'll specify that as well.</p><pre class="codeinput">D = importdata(<span class="string">'orbit91.txt'</span>); <span class="comment">%</span>

kyear = -D.data(:,1);
insol_65NJul = D.data(:,6);

Fsw=daily_insolation(kyear,65,(7-3)*30,2,<span class="string">'constant'</span>,1360);

figure
plot(kyear,1-insol_65NJul./Fsw)
</pre><img vspace="5" hspace="5" src="daily_insolation_documentation_06.png" alt=""> <p>Note, the values above agree within 3e-5.</p><h2 id="11">Example 6</h2><p>Plot 65N integrated summer insolation as in <a href="http://dx.doi.org/10.1126/science.1125249">Huybers (2006), Science 313 508-511</a>:</p><pre class="codeinput">[kyear,day]=meshgrid(1000:1:2000,1:1:365);
Fsw = daily_insolation(kyear,65,day);
Fsw(Fsw&lt;275)=0;

figure
plot(-(1000:1:2000),sum(Fsw,1)*86400*10^-9)
title(<span class="string">'As in Huybers (2006) Fig. 2C'</span>)
</pre><img vspace="5" hspace="5" src="daily_insolation_documentation_07.png" alt=""> <h2 id="12">Detailed description of calculation:</h2><p>Values for eccentricity, obliquity, and longitude of perihelion for the past 5 Myr are taken from Berger and Loutre 1991 (data from ncdc.noaa.gov). If using calendar days, solar longitude is found using an approximate solution to the differential equation representing conservation of angular momentum (Kepler's Second Law).  Given the orbital parameters and solar longitude, daily average insolation is calculated exactly following Berger 1978.</p><h2 id="13">References:</h2><div><ul><li>Berger A. and Loutre M.F. (1991). Insolation values for the climate of  the last 10 million years. Quaternary Science Reviews, 10(4), 297-317.</li><li>Berger A. (1978). Long-term variations of daily insolation and  Quaternary climatic changes. Journal of Atmospheric Science, 35(12),  2362-2367.</li><li>Huybers, Peter. "Early Pleistocene glacial cycles and the integrated summer insolation forcing." science 313.5786 (2006): 508-511.</li></ul></div><h2 id="14">Authors:</h2><p>Ian Eisenman and Peter Huybers, Harvard University, August 2006 <a href="mailto:eisenman@fas.harvard.edu">eisenman@fas.harvard.edu</a>. Slightly modified by Chad A. Greene for inclusion in the Climate Data Toolbox for Matlab, 2019.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% |daily_insolation| documentation
% |daily_insolation| computes daily average insolation as a function of day and latitude at
% any point during the past 5 million years.
% 
% This function is from Ian Eisenman and Peter Huybers (see the reference
% below). The |daily_insolation| function is quite similar to the <solar_radiation_documentation.html |solar_radiation|> 
% function, but one may suit your needs better than the other. The |daily_insolation| 
% function is best suited for investigations involving orbital changes over 
% thousands to millions of years, whereas the |solar_radiation| may be easier to use
% for applications such as present-day precipitation/drought research. 
% 
% <CDT_Contents.html Back to Climate Data Tools Contents>. 
%% Syntax 
%  
%  Fsw = daily_insolation(kyear,lat,day)
%  Fsw = daily_insolation(kyear,lat,day,day_type)
%  Fsw = daily_insolation(kyear,lat,day,day_type,'constant',So)
%  Fsw = daily_insolation(kyear,lat,day,day_type,'mjmd')
%  [Fsw, ecc, obliquity, long_perh] = daily_insolation(...)
% 
%% Description
% 
% |Fsw = daily_insolation(kyear,lat,day)| gives the daily average insolation
% in W/m^2 at latitude(s) on specified day(s) of the year (as given by the
% <doy_documentation.html |doy|> function) for the times |kyear|, which are thousands of years before
% present. For example, use |kyear = +3000| to indicate 3 million years
% before present. Maximum allowed value of |kyear| is |5000|. 
% 
% |Fsw = daily_insolation(kyear,lat,day,day_type)| specifies an optional day
% type as |1| (default) or |2|. The default option |1| specifies days in the
% range 1 to 365.24, where day 1 is January first and the vernal equinox
% always occurs on day 80. Option 2 specifies day input as solar longitude
% in the range 0 to 360 degrees. Solar longitude is the angle of the Earth's 
% orbit measured from spring equinox (21 March). Note that calendar days and
% solar longitude are not linearly related because, by Kepler's Second Law, Earth's
% angular velocity varies according to its distance from the sun. If day_type 
% is negative, |kyear| is taken to be a 3 element array containing [eccentricity,
% obliquity, and longitude of perihelion].
%  
% |Fsw = daily_insolation(kyear,lat,day,day_type,'constant',So)| specfies a
% solar constant |So|. Default |So| is |1365| W/m^2.  
% 
% |Fsw = daily_insolation(kyear,lat,day,day_type,'mjmd')| returns |Fsw| in units 
% of (MJ/m^2)/day rather than the default W/m^2.
% 
% |[Fsw, ecc, obliquity, long_perh] = daily_insolation(...)| also returns the
% orbital eccentricity, obliquity, and longitude of perihelion (precession angle).
%
%% Example 1
% For this example, calculate summer solstice insolation at 65 N. We'll do
% it two different ways. First, use <doy_documentation.html |doy|> to get
% the day of year corresponding to solstice, assuming it occurs on June 20:

kyr = 0:1000; 

Fsw_jun20 = daily_insolation(kyr,65,doy('june 20'));

plot(kyr,Fsw_jun20)
set(gca,'xdir','reverse') % reverses x direction
ylabel('summer solstice insolation at 65\circN (W m^{-1})')
xlabel 'thousands of years before present'

%% 
% Rather than approximating June 20 as the solstice, a more precise way
% would be to specify the exact orbital angle corresponding to the solstice (90 degrees) 
% using the |day_type=2| option, like this: 

Fsw_exact = daily_insolation(kyr,65,90,2);

hold on
plot(kyr,Fsw_exact)

legend('June 20','exact') 

%% Example 2
% We can plot the difference between June 20 (calendar day) and the exact summer solstice insolation at 65 N

Fsw_jun20 = daily_insolation(kyr,65,doy('june 20'));
Fsw_exact = daily_insolation(kyr,65,90,2);

figure
plot(kyr,Fsw_jun20-Fsw_exact) 
set(gca,'xdir','reverse') % reverses x direction
ylabel('difference in solstice insolation at 65\circN (W m^{-1})')
xlabel 'thousands of years before present'

%% Example 3
% Insolation for the current orbital configuration as a function of day and
% latitude. Since this is a function of two variables, use |meshgrid| to
% create grids of the day and latitude variables: 

[day,lat]=meshgrid(1:5:365, -90:90);
[Fsw,ecc,obl,omega]=daily_insolation(0,lat,day);

disp([ecc,obl,omega]) % displays optional outputs

%% 
% We can now plot insolation as a function of day and latitude like this: 

figure
[c,h]=contour(day,lat,Fsw,[0:50:500]);
clabel(c,h)
xlabel 'day of year'
ylabel 'latitude' 
title 'present day insolation (W m^{-2})'

%% Example 4
% Calculate _annual_ (not daily) average insolation by explicitly
% specifying orbital parameters. 

ecc=0.017236; 
obl=23.446; 
omega=101.37+180;
[day,lat]=meshgrid(1:5:365, -90:90);

Fsw=daily_insolation([ecc,obl,omega],lat,day,-1);

Fsw_annual = mean(Fsw,2); 


figure
plot(-90:90,Fsw_annual)
axis tight
xlabel 'latitude'
ylabel 'annual mean insolation (W m^{-2})'

%% Example 5
% Compare calculated insolation with example values given by Berger (1991).
% Start by loading Earth's orbital parameters from <https://doi.org/10.1016/0277-3791(91)90033-Q Berger A. and Loutre M.F., 1991>, 
% which is included as a sample dataset in CDT. Note, Berger and Loutre used
% negative values for their kiloyears, so we'll have to multiply them by
% -1. Also, they used a solar constant of 1360 W/m^2 so we'll specify that
% as well. 

D = importdata('orbit91.txt'); %

kyear = -D.data(:,1); 
insol_65NJul = D.data(:,6); 

Fsw=daily_insolation(kyear,65,(7-3)*30,2,'constant',1360);

figure
plot(kyear,1-insol_65NJul./Fsw) 

%% 
% Note, the values above agree within 3e-5.

%% Example 6
% Plot 65N integrated summer insolation as in
% <http://dx.doi.org/10.1126/science.1125249  Huybers (2006), Science 313
% 508-511>: 

[kyear,day]=meshgrid(1000:1:2000,1:1:365);
Fsw = daily_insolation(kyear,65,day);
Fsw(Fsw<275)=0;

figure
plot(-(1000:1:2000),sum(Fsw,1)*86400*10^-9)
title('As in Huybers (2006) Fig. 2C')

%% Detailed description of calculation:
% Values for eccentricity, obliquity, and longitude of perihelion for the
% past 5 Myr are taken from Berger and Loutre 1991 (data from
% ncdc.noaa.gov). If using calendar days, solar longitude is found using an
% approximate solution to the differential equation representing conservation
% of angular momentum (Kepler's Second Law).  Given the orbital parameters
% and solar longitude, daily average insolation is calculated exactly
% following Berger 1978.
%
%% References: 
% 
% * Berger A. and Loutre M.F. (1991). Insolation values for the climate of
%  the last 10 million years. Quaternary Science Reviews, 10(4), 297-317.
% * Berger A. (1978). Long-term variations of daily insolation and
%  Quaternary climatic changes. Journal of Atmospheric Science, 35(12),
%  2362-2367.
% * Huybers, Peter. "Early Pleistocene glacial cycles and the integrated 
% summer insolation forcing." science 313.5786 (2006): 508-511.
%
%% Authors:
% Ian Eisenman and Peter Huybers, Harvard University, August 2006
% eisenman@fas.harvard.edu. Slightly modified by Chad A. Greene for inclusion in the Climate
% Data Toolbox for Matlab, 2019. 

##### SOURCE END #####
--></body></html>