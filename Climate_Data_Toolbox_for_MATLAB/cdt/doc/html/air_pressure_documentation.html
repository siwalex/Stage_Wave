
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>air_pressure documentation</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-01-02"><meta name="DC.source" content="air_pressure_documentation.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1><tt>air_pressure</tt> documentation</h1><!--introduction--><p><tt>air_pressure</tt> computes pressure from the baromometric forumula for a US Standard Atmosphere.</p><p>See also <a href="air_density_documentation.html"><tt>air_density</tt></a>.</p><p><a href="CDT_Contents.html">Back to Climate Data Tools Contents</a></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Example 1: Pressure profile</a></li><li><a href="#6">Example 2: Comparison to reanalysis surface pressure</a></li><li><a href="#12">Author Info</a></li></ul></div><h2 id="1">Syntax</h2><pre>P = air_pressure(h)</pre><h2 id="2">Description</h2><p><tt>P = air_pressure(h)</tt> returns the pressure <tt>P</tt> in pascals corresponding to the heights <tt>h</tt> in geometric meters above sea level.</p><h2 id="3">Example 1: Pressure profile</h2><p>The US Standard Atmosphere formula is valid to 86 km above sea level, so let's look at air pressure from sea level to 85 km:</p><pre class="codeinput">h = 0:85e3;

p = air_pressure(h);

figure
plot(p/1000,h/1000)
axis <span class="string">tight</span>
box <span class="string">off</span>
ylabel <span class="string">'height above sea level (km)'</span>
xlabel <span class="string">'pressure (kPa)'</span>
</pre><img vspace="5" hspace="5" src="air_pressure_documentation_01.png" alt=""> <p>The formula uses a piecewise function that calculates an equation based on different constants for different layers of the atmosphere. The bases of those layers are at 0, 11, 20, 32, 47, 51, and 71 km above sea level. For context, we can plot those layer bases as horizontal lines using <a href="hline_documentation.html"><tt>hline</tt></a>:</p><pre class="codeinput">LayerBases = [0 11 20 32 47 51 71];

hline(LayerBases,<span class="string">':'</span>,<span class="string">'color'</span>,rgb(<span class="string">'gray'</span>))
</pre><img vspace="5" hspace="5" src="air_pressure_documentation_02.png" alt=""> <p>Pro tip: For some applictions it may be helpful to display the x axis on a log scale. To do that, we could have plotted the data with <tt>semilogx</tt> instead of using the <tt>plot</tt> function above, or we can change the x scale to log like this:</p><pre class="codeinput">set(gca,<span class="string">'xscale'</span>,<span class="string">'log'</span>)
</pre><img vspace="5" hspace="5" src="air_pressure_documentation_03.png" alt=""> <h2 id="6">Example 2: Comparison to reanalysis surface pressure</h2><p>Consider this global gridded surface pressure data, and we'll just look at the means surface pressure from the year 2017:</p><pre class="codeinput">lat = ncread(<span class="string">'ERA_Interim_2017.nc'</span>,<span class="string">'latitude'</span>);
lon = ncread(<span class="string">'ERA_Interim_2017.nc'</span>,<span class="string">'longitude'</span>);
t = ncread(<span class="string">'ERA_Interim_2017.nc'</span>,<span class="string">'time'</span>);
sp = ncread(<span class="string">'ERA_Interim_2017.nc'</span>,<span class="string">'sp'</span>);

<span class="comment">% Calculate mean surface pressure:</span>
spm = mean(sp,3);

<span class="comment">% Plot the mean surface pressure:</span>
figure
imagescn(lon,lat,spm'/1000)

cb = colorbar;
ylabel(cb,<span class="string">'surface pressure (kPa)'</span>)
caxis([50 105])
</pre><img vspace="5" hspace="5" src="air_pressure_documentation_04.png" alt=""> <p>The first thing you may notice in the figure above, is that surface pressure roughly corresponds to surface topography. Let's show that by overlaying topographic contours. Use <a href="topo_interp_documentation.html"><tt>topo_interp</tt></a> to get surface and seafloor topography, set underwater topography to zero, and overlay contours:</p><pre class="codeinput"><span class="comment">% Get a Lat,Lon grid from the lat,lon arrays:</span>
[Lat,Lon] = meshgrid(lat,lon);

<span class="comment">% Get the surface topography:</span>
z = topo_interp(Lat,Lon);

<span class="comment">% Set underwater values of topography to zero:</span>
z(z&lt;0) = 0;

hold <span class="string">on</span>
contour(Lon,Lat,z,<span class="string">'k'</span>);
</pre><img vspace="5" hspace="5" src="air_pressure_documentation_05.png" alt=""> <p>Clearly there's a relationship between surface pressure and suface topography. Display the relationship as a scatterplot</p><pre class="codeinput">figure
scatter(spm(:)/1000,z(:),8,Lat(:),<span class="string">'filled'</span>)
cb = colorbar;
ylabel(cb,<span class="string">'latitude'</span>)
cmocean <span class="string">delta</span>
xlabel <span class="string">'surface pressure (kPa)'</span>
ylabel <span class="string">'surface elevation (m)'</span>
axis <span class="string">tight</span>
</pre><img vspace="5" hspace="5" src="air_pressure_documentation_06.png" alt=""> <p>Neat scatterplot, but how does it compare to the theoretical elevation-only dependent air pressure from the US Standard Atmosphere?</p><pre class="codeinput">p = air_pressure(z);

hold <span class="string">on</span>
plot(p(:)/1000,z(:),<span class="string">'r.'</span>)
legend(<span class="string">'ERA-Interim'</span>,<span class="string">'US Standard Atmosphere'</span>)
</pre><img vspace="5" hspace="5" src="air_pressure_documentation_07.png" alt=""> <p>Want a quantitative measure of how well the theory copares to the reanalysis data? There are many ways to quantify that relationship, like correlation coefficients and p values. Another measure of mismatch is the the root-mean-square difference between the two:</p><pre class="codeinput">rms([spm(:) - p(:)],<span class="string">'omitnan'</span>)/1000
</pre><pre class="codeoutput">ans =
    1.8792
</pre><p>The rms difference is about 1.88 kPa.</p><h2 id="12">Author Info</h2><p>This function is part of the <a href="http://www.github.com/chadagreene/CDT">Climate Data Toolbox for Matlab</a>. The function and supporting documentation were written by Chad A. Greene of the University of Texas at Austin.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% |air_pressure| documentation
% |air_pressure| computes pressure from the baromometric forumula for a US Standard Atmosphere. 
% 
% See also <air_density_documentation.html |air_density|>.
% 
% <CDT_Contents.html Back to Climate Data Tools Contents>
%% Syntax
% 
%  P = air_pressure(h)
% 
%% Description
%
% |P = air_pressure(h)| returns the pressure |P| in pascals corresponding to
% the heights |h| in geometric meters above sea level.
% 
%% Example 1: Pressure profile
% The US Standard Atmosphere formula is valid to 86 km above sea level, so
% let's look at air pressure from sea level to 85 km: 

h = 0:85e3; 

p = air_pressure(h); 

figure 
plot(p/1000,h/1000)
axis tight
box off 
ylabel 'height above sea level (km)' 
xlabel 'pressure (kPa)' 

%% 
% The formula uses a piecewise function that calculates an equation based
% on different constants for different layers of the atmosphere. The bases
% of those layers are at 0, 11, 20, 32, 47, 51, and 71 km above sea level. 
% For context, we can plot those layer bases as horizontal lines using
% <hline_documentation.html |hline|>:

LayerBases = [0 11 20 32 47 51 71]; 

hline(LayerBases,':','color',rgb('gray'))

%%
% Pro tip: For some applictions it may be helpful to display the x axis on
% a log scale. To do that, we could have plotted the data with |semilogx| instead of
% using the |plot| function above, or we can change the x scale to log like this: 

set(gca,'xscale','log')

%% Example 2: Comparison to reanalysis surface pressure
% Consider this global gridded surface pressure data, and we'll just look
% at the means surface pressure from the year 2017: 

lat = ncread('ERA_Interim_2017.nc','latitude');
lon = ncread('ERA_Interim_2017.nc','longitude');
t = ncread('ERA_Interim_2017.nc','time');
sp = ncread('ERA_Interim_2017.nc','sp');

% Calculate mean surface pressure: 
spm = mean(sp,3); 

% Plot the mean surface pressure: 
figure
imagescn(lon,lat,spm'/1000)

cb = colorbar; 
ylabel(cb,'surface pressure (kPa)')
caxis([50 105])

%% 
% The first thing you may notice in the figure above, is that surface
% pressure roughly corresponds to surface topography. Let's show that by overlaying
% topographic contours. Use <topo_interp_documentation.html |topo_interp|> to 
% get surface and seafloor topography, set underwater topography to zero,
% and overlay contours: 

% Get a Lat,Lon grid from the lat,lon arrays:  
[Lat,Lon] = meshgrid(lat,lon); 

% Get the surface topography: 
z = topo_interp(Lat,Lon); 

% Set underwater values of topography to zero: 
z(z<0) = 0; 

hold on
contour(Lon,Lat,z,'k');

%% 
% Clearly there's a relationship between surface pressure and suface
% topography. Display the relationship as a scatterplot

figure
scatter(spm(:)/1000,z(:),8,Lat(:),'filled') 
cb = colorbar; 
ylabel(cb,'latitude')
cmocean delta
xlabel 'surface pressure (kPa)' 
ylabel 'surface elevation (m)'
axis tight 

%%
% Neat scatterplot, but how does it compare to the theoretical
% elevation-only dependent air pressure from the US Standard Atmosphere? 

p = air_pressure(z); 

hold on
plot(p(:)/1000,z(:),'r.')
legend('ERA-Interim','US Standard Atmosphere')

%% 
% Want a quantitative measure of how well the theory copares to the reanalysis 
% data? There are many ways to quantify that relationship, like correlation
% coefficients and p values. Another measure of mismatch is the the root-mean-square difference
% between the two: 

rms([spm(:) - p(:)],'omitnan')/1000

%% 
% The rms difference is about 1.88 kPa. 

%% Author Info
% This function is part of the <http://www.github.com/chadagreene/CDT Climate Data Toolbox for Matlab>.
% The function and supporting documentation were written by Chad A. Greene
% of the University of Texas at Austin. 
##### SOURCE END #####
--></body></html>